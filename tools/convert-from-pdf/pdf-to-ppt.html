<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üöÄ PDF to PowerPoint | FilePro Future</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Share+Tech+Mono&display=swap">
  <!-- Neon and glassmorphism styling -->
  <style>
    :root {
      --accent: #00fff0;
      --whiteish: #eafffd;
      --darkglass: rgba(15, 32, 39, 0.90);
      --cardglass: rgba(40,60,84,0.25);
      --shadow: 0 0 32px 8px #00fff088;
    }
    body, html {
      min-height: 100%;
      margin: 0;
      background: linear-gradient(135deg, #0f2027 40%, #2c5364 100%);
      color: var(--whiteish);
      font-family: 'Orbitron', 'Share Tech Mono', monospace;
      transition: background 0.8s;
    }
    body.darkmode {
      background: linear-gradient(135deg, #222a31 40%, #242943 100%);
      color: #d0f4f7;
    }
    header, footer {
      background: var(--darkglass);
      padding: 18px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1.5px solid var(--accent);
      border-radius: 0 0 18px 18px;
      box-shadow: var(--shadow);
      font-size: 18px;
    }
    .logo {
      font-size: 28px;
      font-weight: bold;
      color: var(--accent);
      letter-spacing: 2px;
      text-shadow: 0 0 18px var(--accent), 0 0 2px #fff;
    }
    nav a {
      color: var(--whiteish);
      margin: 0 22px;
      text-decoration: none;
      font-weight: bold;
      letter-spacing: 1px;
      position: relative;
      transition: color 0.3s;
    }
    nav a::after {
      content: "";
      display: block;
      margin: auto;
      margin-top: 3px;
      height: 2px;
      width: 0;
      background: linear-gradient(90deg, var(--accent) 50%,transparent 100%);
      transition: width .35s;
    }
    nav a:hover {
      color: var(--accent);
    }
    nav a:hover::after {
      width: 100%;
    }
    .darkmode-toggle {
      background: none;
      border: 2px solid var(--accent);
      color: #fff;
      border-radius: 22px;
      font-size: 18px;
      padding: 6px 17px;
      margin-left: 24px;
      outline: none;
      cursor: pointer;
      transition: background 0.25s, box-shadow 0.25s;
      box-shadow: 0 0 0 transparent;
    }
    .darkmode-toggle.active {
      background: var(--accent);
      color: #000;
      box-shadow: var(--shadow);
    }
    main.page {
      max-width: 1100px;
      margin: 50px auto 5vw auto;
      background: var(--cardglass);
      border-radius: 25px;
      box-shadow: var(--shadow);
      padding: 38px 5vw;
      backdrop-filter: blur(13px);
      animation: fadein-more 1.1s;
      position: relative;
    }
    @keyframes fadein-more {
      from { opacity: 0; transform: scale(0.94);}
      to { opacity: 1; transform: scale(1);}
    }
    h1 {
      color: var(--accent);
      text-align: center;
      letter-spacing: 2px;
      text-shadow: 0 0 18px #00a1a355, 0 0 2px #fff;
      font-size: 2.2em;
      margin-bottom: 16px;
    }
    .upload-area {
      border: 2.5px dashed var(--accent);
      padding: 50px 20px 60px 20px;
      border-radius: 22px;
      text-align: center;
      font-size: 22px;
      cursor: pointer;
      margin-bottom: 38px;
      position: relative;
      background: rgba(15, 32, 39, 0.3);
      box-shadow: 0 3px 24px 2px #00f3ee10;
      transition: background .2s, box-shadow .35s;
      overflow: hidden;
      z-index: 2;
      will-change: box-shadow, background;
    }
    .upload-area.dragover, .upload-area:hover {
      background: rgba(0,255,255,0.13);
      box-shadow: 0 0 0 3.5px var(--accent);
      border-color: #00ffe7;
    }
    #file-name {
      margin-top: 15px;
      color: var(--accent);
      font-family: 'Share Tech Mono', monospace;
      font-size: 18px;
      font-weight: bold;
    }
    input[type="file"] { display: none }
    .tool-btn, .tool-btn:visited {
      background: linear-gradient(135deg, #00fff0 10%, #07d5ff 100%);
      color: #17171a;
      padding: 15px 39px;
      border: none;
      border-radius: 11px;
      font-size: 1.27em;
      font-weight: bold;
      box-shadow: 0 0 16px #00fff088;
      margin: 35px 0 0 0;
      cursor: pointer;
      transition: all 0.35s;
      letter-spacing: 1px;
    }
    .tool-btn:hover {
      transform: scale(1.08);
      filter: brightness(1.15);
      box-shadow: var(--shadow),0 0 25px #fff3;
    }
    #loading {
      display: none;
      text-align: center;
      margin-top: 38px;
      opacity: 0.92;
      font-size: 1.25em;
      animation: holo-glow 2.5s infinite alternate;
    }
    .holo-spinner {
      width: 64px; height: 64px; margin: 0 auto 8px auto;
      border: 6px solid rgba(0,255,255,0.1);
      border-top: 6px solid var(--accent);
      border-radius: 50%;
      animation: spin 1.1s linear infinite;
      box-shadow: 0 0 25px #00fff0cc;
      filter: drop-shadow(0 0 15px #00fff0aa);
    }
    @keyframes spin { to {transform:rotate(360deg);} }
    @keyframes holo-glow {
      0% {text-shadow: 0 0 12px #22fff0, 0 0 8px #fff3;}
      100% {text-shadow: 0 0 24px #0af, 0 0 5px #fff;}
    }
    #download-section {
      text-align: center;
      display: none;
      margin-top: 32px;
      animation: fadein-more .9s;
    }
    .preview-section {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      margin: 15px 0 0  0;
      justify-content: center;
      font-size: 0.95em;
    }
    .preview-thumb {
      background: #202b3a;
      border: 2.5px solid #00fff077;
      border-radius: 10px;
      margin: 4px 7px;
      overflow: hidden;
      box-shadow: 0 2px 13px #00fff033;
      width: 118px; height: 160px;
      position:relative;
      transition: transform .22s;
    }
    .preview-thumb img {
      width:100%; height:100%; display:block; object-fit:cover;
      filter: drop-shadow(0 0 7px #00fff022);
    }
    .preview-thumb:hover {
      transform: scale(1.09);
      box-shadow: 0 2px 29px #00fff099;
      border-color: #00fff0bb;
    }
    .progress-ring {
      margin: 0 auto 8px auto;
      width: 77px;
      height: 77px;
      display: block;
    }
    .error-message {
      color: #ff6070;
      font-weight: bold;
      margin: 16px 0 0 0;
      text-align: center;
      background: rgba(40,0,40,0.13);
      border-radius: 7px;
      padding: 6.5px 0;
      box-shadow: 0 0 7px #310;
      letter-spacing: 1px;
      border: 1.5px solid #fdf;
    }
    /* Glass/holo borders for cards/features */
    .feature-cards {
      display:flex; gap:28px; margin-top:60px; justify-content:center; flex-wrap: wrap;
    }
    .feature-card {
      background: var(--cardglass);
      border-radius: 16px;
      border: 1.3px solid var(--accent);
      box-shadow: 0 0 11px #00fff033;
      padding: 19px 33px 18px;
      text-align: center;
      width: 235px;
      font-size:1.07em;
      margin-bottom: 22px;
      transition: box-shadow 0.36s;
    }
    .feature-card:hover {box-shadow:0 0 28px #00fff088;}
    .feature-card .icon {
      font-size:2.2em;
      color:var(--accent);
      margin-bottom:6px;
      text-shadow: 0 0 12px #00fff0cc;
    }
    @media (max-width: 800px) {
      main.page {padding: 2vw;}
      .feature-card {width: 95vw;}
      .feature-cards {flex-direction:column;}
    }
  </style>
  <!-- pdf.js for PDF parsing -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.2.67/pdf.min.js"></script>
  <!-- PptxGenJS for dynamic pptx creation -->
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.min.js"></script>
</head>
<body>
<header>
  <div class="logo">‚ö° FilePro&nbsp;<span style="font-size:1.1em;font-weight:400;">Future</span></div>
  <nav>
    <a href="../../index.html">Home</a>
    <a href="../../tools.html">Tools</a>
    <a href="../../about.html">About</a>
    <a href="../../contact.html">Contact</a>
    <button class="darkmode-toggle" id="darkSwitch" onclick="toggleDarkMode()">üåë</button>
  </nav>
</header>

<main class="page">
  <h1>PDF to PowerPoint Converter</h1>
  <div class="upload-area" id="drop-area">
    <input type="file" id="pdf-upload" accept=".pdf" />
    <p><span style="font-size:1.4em;">üîó</span> <b>Click or Drop PDF File Here</b></p>
    <div id="file-name"></div>
  </div>

  <div class="error-message" id="error-message" style="display:none;"></div>

  <div id="loading">
    <div class="holo-spinner"></div>
    <div id="loadingmessage">Scanning your PDF...</div>
    <svg class="progress-ring" id="progressRing" viewBox="0 0 66 66"><circle cx="33" cy="33" r="30" stroke="#00fff0" stroke-width="6" fill="none" style="stroke-dasharray:188;stroke-dashoffset:188;"></circle></svg>
  </div>

  <div class="preview-section" id="preview-section" style="display:none;"></div>

  <div id="download-section">
    <button class="tool-btn" onclick="downloadPPT()">‚¨áÔ∏è Download PowerPoint File</button>
  </div>

  <!-- Futuristic feature highlights -->
  <section class="feature-cards">
    <div class="feature-card">
      <div class="icon">üñºÔ∏è</div>
      <b>Crystal-Clear Slides</b>
      <div>Extracts each PDF page as a high-DPI slide image‚Äîperfect layout, every time.</div>
    </div>
    <div class="feature-card">
      <div class="icon">üï≥Ô∏è</div>
      <b>100% Private</b>
      <div>Runs in your browser, no server uploads‚Äîyour files never leave your device.</div>
    </div>
    <div class="feature-card">
      <div class="icon">üöÄ</div>
      <b>Lightning Fast</b>
      <div>Fast conversion, neon-glow interface, real-time preview thumbnails.</div>
    </div>
    <div class="feature-card">
      <div class="icon">üõ°Ô∏è</div>
      <b>Built for Security</b>
      <div>All processing is local, and your downloaded PPTX is erased after session.</div>
    </div>
    <div class="feature-card">
      <div class="icon">üåó</div>
      <b>Auto Dark Mode</b>
      <div>Switch look to night or light, seamlessly.</div>
    </div>
    <div class="feature-card">
      <div class="icon">ü•Ω</div>
      <b>Futuristic Holo UI</b>
      <div>Glass, hologram glow, and animated transitions for a true next-gen experience.</div>
    </div>
  </section>
</main>

<footer>
  &copy; 2025 FilePro. All rights reserved.
</footer>

<script>
let pptxBlob = null, pptxFilename = "converted_presentation.pptx";
let slideThumbs = [];
const fileInput = document.getElementById("pdf-upload");
const fileNameDiv = document.getElementById("file-name");
const dropArea = document.getElementById("drop-area");
const errorDiv = document.getElementById("error-message");
const previewSection = document.getElementById("preview-section");
const progressRing = document.getElementById("progressRing").querySelector("circle");

function setError(msg) {
  errorDiv.style.display = "block";
  errorDiv.textContent = msg;
}

function clearError() {
  errorDiv.style.display = "none";
}

function toggleDarkMode() {
  document.body.classList.toggle("darkmode");
  let btn = document.getElementById("darkSwitch");
  btn.classList.toggle("active");
  btn.textContent = document.body.classList.contains("darkmode") ? "‚òÄÔ∏è" : "üåë";
}

fileInput.addEventListener("change", handlePDFFile, false);

dropArea.addEventListener("click", () => fileInput.click());
dropArea.addEventListener("dragover", e => { e.preventDefault(); dropArea.classList.add("dragover"); });
dropArea.addEventListener("dragleave", e => { e.preventDefault(); dropArea.classList.remove("dragover"); });
dropArea.addEventListener("drop", e => {
  e.preventDefault(); dropArea.classList.remove("dragover");
  let files = e.dataTransfer.files;
  if(files.length && files[0].type==="application/pdf") {
    fileInput.files = files;
    handlePDFFile();
  } else {
    setError("Please upload a valid PDF file.");
  }
});

function resetUI() {
  fileNameDiv.textContent = "";
  previewSection.style.display = "none";
  previewSection.innerHTML = "";
  pptxBlob = null; slideThumbs = [];
  document.getElementById("loading").style.display = "none";
  document.getElementById("download-section").style.display = "none";
  clearError();
}

async function handlePDFFile() {
  resetUI();
  const file = fileInput.files[0];
  if(!file) return;
  if(file.size > 40*1024*1024) { // 40MB limit
    setError("File is too large (max 40MB).");
    return;
  }
  if(file.type !== "application/pdf") {
    setError("This is not a valid PDF file.");
    return;
  }
  fileNameDiv.textContent = `Selected: ${file.name}`;
  pptxFilename = (file.name.replace(/\.[^.]+$/, "")||"converted") + ".pptx";
  await convertPDFToPPT(file);
}

function animateProgress(ratio) {
  let perimeter = 2 * Math.PI * 30; // r=30
  progressRing.style.strokeDasharray = perimeter;
  progressRing.style.strokeDashoffset = perimeter - ratio*perimeter;
}

async function convertPDFToPPT(file) {
  document.getElementById("loading").style.display = "block";
  document.getElementById("loadingmessage").textContent = "Parsing PDF...";
  animateProgress(0);

  // Step 1: Load PDF with pdf.js
  let arrayBuffer = await file.arrayBuffer();
  let pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;

  let pptx = new PptxGenJS();
  pptx.author = "FilePro Future Converter";
  pptx.company = "FilePro.ai";
  pptx.title = pptxFilename;

  // Collect slide thumbnails for preview
  slideThumbs = [];
  previewSection.innerHTML = '<div style="font-size:1.05em;color:#9cf;text-align:center;width:100%;">Previewing slides‚Ä¶</div>';
  previewSection.style.display = "flex";
  let pdfPageImgs = [];

  // Step 2: Render each page as image, build slide, show preview
  let DPI = 192; // High-res for sharpness
  for(let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
    document.getElementById("loadingmessage").textContent = `Rendering page ${pageNum} of ${pdf.numPages}‚Ä¶`;
    animateProgress(pageNum/pdf.numPages*.7);

    let page = await pdf.getPage(pageNum);
    let viewport = page.getViewport({scale:1});
    // Adjust canvas to fit 16:9 pptx pages (wide), but keep aspect
    let [pptWidthInch, pptHeightInch] = [13.33, 7.5], aspect = viewport.width/viewport.height;
    let canvas = document.createElement("canvas");
    let scale = DPI/72; // PDF points are 72/inch, we want DPI/inch
    canvas.width = viewport.width * scale;
    canvas.height = viewport.height * scale;
    let ctx = canvas.getContext("2d");
    await page.render({canvasContext: ctx, viewport: page.getViewport({scale})}).promise;

    // To preview, shrink to 120px tall
    let thumbCanvas = document.createElement("canvas");
    let thumbScale = 120/(canvas.height);
    thumbCanvas.width = canvas.width*thumbScale;
    thumbCanvas.height = 120;
    thumbCanvas.getContext("2d").drawImage(canvas,0,0,thumbCanvas.width,120);
    let thumbURL = thumbCanvas.toDataURL("image/jpeg", 0.9);
    slideThumbs.push(thumbURL);

    // For pptx slide: use full-res image, scale to slide, center with margins
    let imgData = canvas.toDataURL("image/jpeg",0.99);
    pdfPageImgs.push(imgData);

    animateProgress((pageNum/pdf.numPages)*.7);

    await new Promise(res => setTimeout(res,15)); // animation
  }

  // Step 3: Show preview thumbnails
  previewSection.innerHTML = slideThumbs.map((url,i)=>`<div class="preview-thumb"><img src="${url}" alt="Page ${i+1}"></div>`).join("");
  previewSection.style.display = "flex";

  // Step 4: Compose pptx slides from images
  document.getElementById("loadingmessage").textContent = "Building slides‚Ä¶";
  animateProgress(0.82);

  for(let i=0;i<pdfPageImgs.length;i++) {
    pptx.addSlide({ masterName: "empty" }).addImage({
      data: pdfPageImgs[i],
      x: 0, y: 0,
      w: pptx.width,
      h: pptx.height,
      sizing: { type:'contain', w: pptx.width, h:pptx.height }
    });
    animateProgress(.7+.25*((i+1)/pdfPageImgs.length));
    await new Promise(res => setTimeout(res,12)); // for smooth progress
  }

  animateProgress(1.0);
  document.getElementById("loadingmessage").textContent = "Packaging PowerPoint file‚Ä¶";
  await new Promise(res => setTimeout(res,150));

  // Step 5: Export pptx as Blob for download
  pptx.write('blob').then(function (blob) {
    pptxBlob = blob;
    document.getElementById("loading").style.display = "none";
    document.getElementById("download-section").style.display = "block";
    document.getElementById("loadingmessage").textContent = "";
    animateProgress(0);
  }).catch(e=>{
    setError("Error saving .pptx: "+e);
    document.getElementById("loading").style.display = "none";
  });
}

// Download action
function downloadPPT() {
  if (!pptxBlob) { alert("Office file not ready."); return; }
  let a = document.createElement("a");
  a.href = URL.createObjectURL(pptxBlob);
  a.download = pptxFilename;
  a.style.display = "none";
  document.body.appendChild(a);
  a.click();
  setTimeout(()=>{URL.revokeObjectURL(a.href); a.remove();},1100);
}

// "Auto" dark mode suggestion
if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches)
  document.body.classList.add("darkmode");

// Support filename prompt on right-click Download
document.getElementById("download-section").addEventListener("contextmenu", function(ev){
  ev.preventDefault();
  let name = prompt("Change output filename:", pptxFilename) || pptxFilename;
  pptxFilename = name.replace(/[\s:]/g,"_");
  downloadPPT();
});

// Keyboard ctrl+o for open file
window.addEventListener("keydown",e=>{
  if((e.ctrlKey||e.metaKey)&&e.key==="o") {
    e.preventDefault(); fileInput.click();
  }
});
</script>

</body>
</html>
